# 中国家族树AI应用 - 国内免费部署指南（小白版）

## 🎯 为什么选择国内平台？
- **访问速度快**：服务器在国内，访问延迟低
- **无网络限制**：无需担心跨境网络问题
- **中文界面**：操作更友好，适合新手
- **政策稳定**：国内服务商，使用更安心

## 📋 推荐的国内免费部署平台

### 1. 新浪云SAE（推荐新手）
**优势：**
- 新用户赠送100元体验金（约3个月免费使用）
- 支持Node.js应用
- 提供免费MySQL数据库（500MB）
- 中文界面，操作简单
- 支持一键部署

**限制：**
- 免费额度有限，需要实名认证
- 数据库需要额外配置

### 2. 腾讯云开发CloudBase
**优势：**
- 提供免费的云函数和云数据库
- 支持Node.js运行环境
- 集成了CDN加速
- 腾讯云生态完整

**限制：**
- 免费额度：云函数4万次/月，数据库2GB
- 配置相对复杂

### 3. 阿里云函数计算FC
**优势：**
- 新用户有免费额度
- 支持多种编程语言
- 弹性扩展，按需付费

**限制：**
- 配置较为复杂
- 免费额度较低（40万次调用/月）

## 🚀 新浪云SAE部署教程（推荐方案）

### 第1步：注册新浪云账号

1. 访问 [新浪云官网](https://www.sinacloud.com/)
2. 点击右上角「注册」按钮
3. 使用手机号注册账号
4. 完成实名认证（国内服务商要求）
5. 领取新用户100元体验金

### 第2步：创建MySQL数据库

1. 登录后，点击左侧菜单「数据库」
2. 点击「创建数据库」
3. 填写数据库信息：
   - **数据库类型**：MySQL 5.7
   - **数据库名称**：`family_tree_db`
   - **用户名**：`family_user`
   - **密码**：设置一个安全的密码（记住这个密码）
   - **容量**：选择最小的免费套餐（500MB）
4. 点击「创建」
5. 等待数据库创建完成（约2-3分钟）

### 第3步：准备应用包

1. 在本地电脑上，打开项目文件夹
2. 修改 `server.js` 文件，将数据库连接改为MySQL格式：
   ```javascript
   const databaseUrl = process.env.DATABASE_URL || 'mysql://family_user:你的密码@数据库地址:3306/family_tree_db';
   ```
3. 修改 `schema.prisma` 文件，将数据库类型改为MySQL：
   ```prisma
   datasource db {
     provider = "mysql"
     url      = env("DATABASE_URL")
   }
   ```
4. 安装MySQL依赖：
   ```bash
   npm install mysql2 @prisma/adapter-mysql
   ```
5. 重新生成Prisma客户端：
   ```bash
   npx prisma generate
   ```
6. 打包项目：
   ```bash
   npm run build
   ```

### 第4步：部署Node.js应用

1. 回到新浪云控制台，点击左侧菜单「SAE」
2. 点击「创建应用」
3. 填写应用信息：
   - **应用名称**：`family-tree-ai`
   - **运行环境**：Node.js 16
   - **应用类型**：Web应用
   - **部署方式**：选择「代码包部署」
   - **代码包**：上传打包好的项目文件
4. 点击「下一步」
5. 配置环境变量：
   - `DATABASE_URL`：`mysql://family_user:你的密码@数据库地址:3306/family_tree_db`
   - `PORT`：`8080`（新浪云默认端口）
   - `VITE_AI_API_KEY`：你的API密钥
   - `VITE_AI_BASE_URL`：`https://api.deepseek.com`
   - `VITE_AI_MODEL`：`deepseek-chat`
6. 点击「创建」
7. 等待应用部署完成（约3-5分钟）

### 第5步：运行数据库迁移

1. 在应用详情页面，找到「远程终端」功能
2. 点击「打开终端」
3. 在终端中输入：
   ```bash
   npx prisma migrate dev --name init
   ```
4. 等待数据库迁移完成

### 第6步：访问应用

1. 部署完成后，在应用详情页面找到「访问地址」
2. 点击访问地址，即可打开你的中国家族树AI应用

## 📱 其他国内免费平台快速对比

| 平台 | 免费额度 | 优势 | 劣势 |
|------|----------|------|------|
| **新浪云SAE** | 新用户100元体验金 | 操作简单，中文友好 | 需要实名认证 |
| **腾讯云开发** | 云函数4万次/月，数据库2GB | 大厂稳定，功能丰富 | 配置较复杂 |
| **阿里云函数计算** | 40万次调用/月 | 性能好，弹性扩展 | 新手使用门槛高 |
| **华为云函数工作流** | 每月100万次免费调用 | 企业级支持 | 界面相对复杂 |
| **百度云BAE** | 免费额度有限 | 搜索生态集成 | 文档不够友好 |

## 🔧 国内部署的注意事项

### 1. 数据库兼容性
- **PostgreSQL转MySQL**：新浪云等国内平台主要提供MySQL，需要修改：
  - `schema.prisma`中的provider改为`mysql`
  - `server.js`中的数据库连接字符串
  - 安装MySQL相关依赖

### 2. 网络配置
- **API访问**：确保AI服务的API在国内可以正常访问
- **端口配置**：国内平台通常使用8080或80端口
- **防火墙**：某些端口可能需要在控制台开启

### 3. 实名认证要求
- **所有国内平台**：都需要实名认证才能使用
- **准备材料**：身份证正反面照片
- **认证流程**：通常1-2个工作日完成

### 4. 域名配置
- **免费域名**：平台会提供二级域名（如`xxx.sinaapp.com`）
- **自定义域名**：需要备案（约20天）
- **HTTPS**：大部分平台提供免费SSL证书

## 🆘 新手常见问题

### Q: 国内平台都需要实名认证吗？
A: 是的，根据国内法规，所有云服务都需要实名认证才能使用。

### Q: 免费额度用完了怎么办？
A: 可以选择付费套餐，或者考虑切换到其他平台继续使用免费额度。

### Q: 数据库类型不兼容怎么办？
A: 我们的应用主要支持PostgreSQL，但可以通过修改配置兼容MySQL。

### Q: 部署失败了怎么排查？
A: 查看应用日志，通常能找到具体的错误信息。如果是依赖问题，可以尝试重新安装依赖。

### Q: AI功能在国内能正常使用吗？
A: 只要API服务在国内可以访问，就能正常使用。建议使用国内的AI服务，如百度文心一言、阿里云通义千问等。

## 🎉 新手部署建议

1. **先从新浪云SAE开始**：操作最简单，适合新手入门
2. **做好数据备份**：定期导出数据库，防止数据丢失
3. **合理使用免费额度**：避免不必要的资源消耗
4. **学习基础配置**：了解基本的环境变量和部署概念
5. **遇到问题多查文档**：国内平台的中文文档都很详细

## 📊 国内VS国外平台对比

| 对比项 | 国内平台 | 国外平台 |
|--------|----------|----------|
| **访问速度** | ⭐⭐⭐⭐⭐ 很快 | ⭐⭐⭐ 一般 |
| **操作难度** | ⭐⭐⭐ 中等 | ⭐⭐⭐⭐ 较难 |
| **免费额度** | ⭐⭐⭐ 有限 | ⭐⭐⭐⭐ 较多 |
| **技术支持** | ⭐⭐⭐⭐ 中文支持好 | ⭐⭐⭐ 英文为主 |
| **网络稳定性** | ⭐⭐⭐⭐⭐ 稳定 | ⭐⭐⭐ 可能受跨境影响 |
| **功能丰富度** | ⭐⭐⭐⭐ 够用 | ⭐⭐⭐⭐⭐ 更丰富 |

---

## 📝 总结

作为新手小白，推荐您先尝试**新浪云SAE**平台，它是国内最适合新手的免费部署平台之一。虽然需要实名认证，但操作简单，中文界面友好，非常适合初学者使用。

如果您已经有一定的技术基础，也可以尝试腾讯云开发或阿里云函数计算，这些平台提供了更丰富的功能和更大的免费额度。

无论选择哪个平台，记得做好数据备份，合理使用免费资源，遇到问题多查文档或寻求技术支持。祝您部署顺利！